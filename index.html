<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#ff4d88" />
  <title>For My Love Giuly 💕</title>
  <meta name="description" content="A tiny comfort button full of love notes for Giuly." />
  <link rel="preload" href="style.css?v=3" as="style" />
  <link rel="stylesheet" href="style.css?v=3" />
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64'%3E%3Ctext y='50%' x='50%' dominant-baseline='middle' text-anchor='middle' font-size='48'%3E❤%3C/text%3E%3C/svg%3E" />
</head>
<body>
  <main>
    <h1>Hi Honey 💖</h1>
    <p class="intro">Whenever you miss me, tap below for a little surprise from me:</p>
    <div class="actions">
      <button class="btn" id="comfortBtn" type="button" aria-describedby="messageBox">Click me, my Love 💕</button>
      <button class="btn" id="hugBtn" type="button" style="background:var(--pink-accent);margin-left:0.5em;">Emotional Hug 🤗</button>
      <button class="btn" id="breatheBtn" type="button" style="background:#7ed6df;margin-left:0.5em;">Breathing Exercise ❤️</button>
    </div>
  <div class="daily-challenge-floating" id="dailyChallengeBox"></div>
    </div>
    <div id="breatheOverlay" aria-modal="true" role="dialog" tabindex="-1" style="display:none;">
      <div class="breathe-modal">
        <button class="breathe-close" id="breatheClose" aria-label="Close breathing exercise">×</button>
        <div class="breathe-heart" id="breatheHeart">❤️</div>
        <div class="breathe-instructions" id="breatheInstructions">Breathe in…</div>
        <audio id="breatheAudio" src="calm.mp3" preload="auto" loop></audio>
      </div>
    </div>
    <div id="hugOverlay" aria-hidden="true"></div>
  <!-- No static audio element needed; will create dynamically -->
  <div class="message" id="messageBox" role="status" aria-live="polite" aria-atomic="true"></div>
  <div class="countdown-floating" id="countdownBox" aria-live="polite"></div>
  <div class="heart" aria-hidden="true">❤️</div>

    <div class="background-selector">
      <p>✨ Choose a background you like, Honey:</p>
      <select id="bgSelect" aria-label="Choose background theme">
        <option value="linear-gradient(to right, #fceff9, #e2f0ff)">Soft Pink & Blue</option>
        <option value="linear-gradient(to right, #89f7fe, #66a6ff)">Sky Blue Gradient</option>
        <option value="linear-gradient(to right, #4facfe, #00f2fe)">Ocean Blue</option>
        <option value="linear-gradient(to right, #c2e9fb, #a1c4fd)">Pastel Blue</option>
        <option value="linear-gradient(to right, #ff9a9e, #fad0c4)">Rose Love</option>
        <option value="linear-gradient(to right, #a18cd1, #fbc2eb)">Purple Dream</option>
        <option value="linear-gradient(to right, #43cea2, #185a9d)">Ocean Breeze</option>
        <option value="linear-gradient(to right, #fddb92, #d1fdff)">Sunshine & Sky</option>
        <option value="linear-gradient(to right, #6a11cb, #2575fc)">Royal Blue</option>
        <option value="linear-gradient(to right, #ffecd2, #fcb69f)">Peach Glow</option>
      </select>
    </div>
    <footer>&copy; <span id="year"></span> With endless love.</footer>
  </main>

  <noscript><p style="margin-top:1rem;font-size:.9rem;opacity:.7">This little comfort button needs JavaScript to show the love notes 💕</p></noscript>
  <script>
    // Daily Challenge Feature
    const dailyChallenges = [
      "Send me a selfie with your biggest smile! 😊",
      "Write down three things you’re grateful for today.",
      "Listen to your favorite song and think of me! 🎶",
      "Go for a short walk and take a photo of something beautiful.",
      "Text me a random fun fact about yourself!",
      "Draw a little doodle and send it to me.",
      "Watch a sunset and send me a picture.",
      "Try a new snack and tell me about it!",
      "Send me a voice note saying something you love about us.",
      "Write a short poem about how you feel today.",
      "Find a heart shape in your surroundings and snap a photo.",
      "Make a wish for us and share it with me.",
      "Do a short breathing exercise and let me know how you feel.",
      "Send me a GIF that makes you laugh!",
      "Plan a future date idea and tell me about it.",
      "Share a favorite childhood memory with me.",
      "Try a new hairstyle and show me!",
      "Send me a song recommendation.",
      "Write a letter to your future self about our love.",
      "Take a photo of your favorite cozy spot at home.",
      "Send me a compliment!",
      "Make a list of things you want to do together.",
      "Send me a picture of something that reminds you of me.",
      "Try a new hobby or craft and show me the result!",
      "Send me a picture of your favorite mug or cup.",
      "Share a quote that inspires you today.",
      "Send me a photo of your favorite book or movie.",
      "Make a playlist for us and share it.",
      "Send me a photo of your pet or a cute animal you found online.",
      "Write down a dream you had recently and tell me about it."
    ];

    function getDailyChallenge() {
      // Use the day of the year to rotate challenges
      const now = new Date();
      const start = new Date(now.getFullYear(), 0, 0);
      const diff = now - start;
      const oneDay = 1000 * 60 * 60 * 24;
      const dayOfYear = Math.floor(diff / oneDay);
      return dailyChallenges[dayOfYear % dailyChallenges.length];
    }

    function showDailyChallenge() {
      const box = document.getElementById('dailyChallengeBox');
      box.innerHTML = `<span>${getDailyChallenge()}</span>`;
    }

    showDailyChallenge();
    // Breathing Exercise Feature
    const breatheBtn = document.getElementById('breatheBtn');
    const breatheOverlay = document.getElementById('breatheOverlay');
    const breatheClose = document.getElementById('breatheClose');
    const breatheHeart = document.getElementById('breatheHeart');
    const breatheInstructions = document.getElementById('breatheInstructions');
    const breatheAudio = document.getElementById('breatheAudio');

    let breatheInterval = null;
    const breathePhases = [
      {text: 'Breathe in…', scale: 1.25, duration: 4000},
      {text: 'Hold…', scale: 1.25, duration: 2000},
      {text: 'Breathe out…', scale: 0.85, duration: 4000},
      {text: 'Hold…', scale: 0.85, duration: 2000}
    ];

    function startBreathing() {
      // Start small and immediately grow for 'Breathe in…'
      breatheHeart.style.transition = 'none';
      breatheHeart.style.transform = 'scale(0.85)';
      setTimeout(() => {
        let phase = 0;
        function nextPhase() {
          const p = breathePhases[phase];
          breatheInstructions.textContent = p.text;
          breatheHeart.style.transition = `transform ${p.duration/1000}s cubic-bezier(.4,0,.7,1)`;
          breatheHeart.style.transform = `scale(${p.scale})`;
          phase = (phase + 1) % breathePhases.length;
          breatheInterval = setTimeout(nextPhase, p.duration);
        }
        nextPhase();
      }, 30);
    }

    function stopBreathing() {
      clearTimeout(breatheInterval);
      breatheHeart.style.transform = 'scale(1)';
      breatheInstructions.textContent = '';
    }

    // Fade helpers
    function fadeAudio(audio, from, to, duration, cb) {
      const steps = 30;
      let step = 0;
      const diff = to - from;
      audio.volume = from;
      function next() {
        step++;
        audio.volume = from + (diff * (step/steps));
        if (step < steps) setTimeout(next, duration/steps);
        else { audio.volume = to; if(cb) cb(); }
      }
      next();
    }

    let breatheFadeOut = false;
    const breatheTargetVol = 0.3;

    breatheBtn.addEventListener('click', () => {
      breatheOverlay.style.display = 'flex';
      setTimeout(()=>breatheOverlay.focus(), 50);
      breatheAudio.currentTime = 0;
      breatheAudio.volume = 0;
      breatheAudio.play();
      breatheFadeOut = false;
      fadeAudio(breatheAudio, 0, breatheTargetVol, 1500);
      startBreathing();
    });
    breatheClose.addEventListener('click', () => {
      breatheFadeOut = true;
      fadeAudio(breatheAudio, breatheAudio.volume, 0, 1500, () => {
        breatheAudio.pause();
        breatheOverlay.style.display = 'none';
        stopBreathing();
      });
    });
    // Fade out/in at loop for seamlessness
    breatheAudio.addEventListener('timeupdate', function() {
      if (breatheAudio.duration && breatheAudio.loop && !breatheFadeOut) {
        // Fade out last 1.2s, fade in first 1.2s
        const fadeDur = 1.2;
        if (breatheAudio.currentTime < fadeDur) {
          breatheAudio.volume = breatheTargetVol * (breatheAudio.currentTime/fadeDur);
        } else if (breatheAudio.duration - breatheAudio.currentTime < fadeDur) {
          breatheAudio.volume = breatheTargetVol * ((breatheAudio.duration-breatheAudio.currentTime)/fadeDur);
        } else {
          breatheAudio.volume = breatheTargetVol;
        }
      }
    });
    // ESC closes overlay
    breatheOverlay.addEventListener('keydown', e => {
      if (e.key === 'Escape') { breatheOverlay.style.display = 'none'; breatheAudio.pause(); stopBreathing(); }
    });
    const messages = [
      // Sweet Love Notes
    "I love you more than all the stars in the universe, Honey 🌙✨",
    "You are my sunshine on every cloudy day, Baby 🌞",
    "Every heartbeat of mine whispers your name, my Love 💓",
    "You’re the best part of my day, always 💖",
    "Whenever you smile, the whole world gets brighter 🌸",
    "Being loved by you is the greatest gift I could ever receive 🎁",
    "I fall for you a little more every single day 💕",
    "Your voice is my favorite melody 🎶💓",
    "You are my safe place, my home, my everything 🏡❤️",
    "You’re my dream come true, Honey 🌙💫",
    "You are the love story I always wanted to write 📖💖",
    "My Love, I adore you endlessly 💕",
    "You’re more beautiful than every sunset I’ve ever seen 🌅",
    "Giuly, you are my once-in-a-lifetime kind of love 💍💖",
    "My heart belongs to you and only you ❤️‍🔥",
    "Baby, you’re the reason I believe in magic ✨",
    "Every moment with you is my favorite moment 💕",
    "I’d choose you in every lifetime, Honey 🌹",
    "I never knew true happiness until I met you 💖",

    // Random Facts About Me
    "Fun fact: When I was little, my favorite snack was lemon drops 🍋",
    "Sometimes I hear a song and instantly think of you 🎶💕",
    "I always think of you when I see the color blue 💙",
    "I still remember the first time you called me 'my Love' 😍",

    // Mood Boosters
    "Close your eyes and feel my arms around you 🤗💓",
    "Take a deep breath, Baby — I’m always with you, even from afar 💞",
    "No matter how far apart we are, we share one heart ❤️",
    "Giuly, you are stronger than you think 💪💕",
    "You’re so loved, cherished, and adored, Honey 💖",
    "The world is brighter and kinder because you are in it 🌍✨",
    "Smile, my Love — it looks beautiful on you 😊💕",
    "Even your toughest days can’t dim your amazing light 🌟",
    "Imagine me holding your hand right now — I never let go 🤝💓",
    "You are magic, you are love, you are my everything ✨💖",
    "The distance is only temporary — our love is forever ❤️",
    "Remember: you are never alone, Honey, I’m always with you 💕",
    "Every second we’re apart is just another step closer to us being together 💞",
    "Baby, you’ve got this — and I’ve always got you 💖",
    "Your heart is golden, your soul is beautiful, and you’re perfect to me 💎💓",
    "No storm lasts forever — and I’ll always be your rainbow 🌈💖",
    "Even when you’re tired, remember you are my strongest, bravest Love 💪💕",
    "Honey, the universe is proud of you, and so am I 🌌💖",
    "Every day, I’m grateful that the world brought me to you 🙏💕",
    "Giuly, you make my life sweeter just by being you 🍯💓",
    ];

    function showMessage() {
      const box = document.getElementById('messageBox');
      const randomIndex = Math.floor(Math.random() * messages.length);
      box.textContent = messages[randomIndex];
    }

    function changeBackground(value) {
      document.body.style.background = value;
    }


    // Event wiring after DOM is parsed
    const btn = document.getElementById('comfortBtn');
    const select = document.getElementById('bgSelect');
    const hugBtn = document.getElementById('hugBtn');
    const hugOverlay = document.getElementById('hugOverlay');
    btn.addEventListener('click', showMessage);
    select.addEventListener('change', (e) => changeBackground(e.target.value));

    // Enter / Space accessibility (some browsers already handle button Enter, but we ensure Space).
    btn.addEventListener('keydown', (e) => {
      if (e.code === 'Space') { e.preventDefault(); showMessage(); }
    });

    // Emotional Hug Feature
    // Emotional Hug: fetch manifest and play random sound
    let hugSounds = null;
    async function getHugSounds() {
      if (hugSounds) return hugSounds;
      try {
        const resp = await fetch('hugsounds/manifest.json');
        const arr = await resp.json();
        hugSounds = arr.map(f => 'hugsounds/' + f);
        return hugSounds;
      } catch (e) {
        return [];
      }
    }

    hugBtn.addEventListener('click', async () => {
      const sounds = await getHugSounds();
      if (!sounds.length) return alert('No hug sounds found!');
      // Pick a random sound
      const sound = sounds[Math.floor(Math.random()*sounds.length)];
      // Remove any previous audio
      let prev = document.getElementById('hugAudioDynamic');
      if (prev) prev.remove();
      // Create and play audio
      const audio = document.createElement('audio');
      audio.id = 'hugAudioDynamic';
      audio.src = sound;
      audio.preload = 'auto';
      audio.style.display = 'none';
      document.body.appendChild(audio);
      try { audio.currentTime = 0; audio.play(); } catch(e){}

      // Clear overlay
      hugOverlay.innerHTML = '';
      hugOverlay.classList.add('active');
      // Add 32 floating hearts/flowers
      const icons = ['❤️','💖','💐','🌸','💞','🌷','💗','💝','🌺','💓'];
      for(let i=0;i<32;i++){
        const el = document.createElement('span');
        el.className = 'hug-float';
        el.textContent = icons[Math.floor(Math.random()*icons.length)];
        el.style.left = Math.random()*100+'vw';
        el.style.animationDelay = (Math.random()*0.8)+'s';
        el.style.fontSize = (Math.random()*1.2+1.2)+'em';
        hugOverlay.appendChild(el);
      }
      // Remove overlay after 3.5s
      setTimeout(()=>{ hugOverlay.classList.remove('active'); hugOverlay.innerHTML=''; }, 3500);
      // Remove audio after playback
      audio.addEventListener('ended', ()=>audio.remove());
    });

    // Countdown logic
    function updateCountdown() {
      const countdownBox = document.getElementById('countdownBox');
      // Set your next meeting date here (YYYY-MM-DDTHH:MM:SS in local time or UTC)
      const nextMeeting = new Date('2025-09-27T00:00:00');
      const now = new Date();
      const diff = nextMeeting - now;
      if (diff <= 0) {
        countdownBox.textContent = "It's time! You're together now! 💖";
        return;
      }
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
      const mins = Math.floor((diff / (1000 * 60)) % 60);
      const secs = Math.floor((diff / 1000) % 60);
      countdownBox.textContent = `⏳ ${days} day${days!==1?'s':''}, ${hours}h ${mins}m ${secs}s until we see each other!`;
    }
    setInterval(updateCountdown, 1000);
    updateCountdown();

    // Initial year and first message prefill (optional)
    document.getElementById('year').textContent = new Date().getFullYear();
    showMessage();
  </script>
</body>
</html>